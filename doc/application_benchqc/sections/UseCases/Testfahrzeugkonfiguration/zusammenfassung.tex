\subsection{Anwendungsfall Testfahrzeugkonfiguration}\label{subsec:anwendungsfall-testfahrzeugkonfiguration}

Bevor ein neues Fahrzeug in Serie produziert werden kann,
müssen mit Vorserienfahrzeugen eine bestimmte Anzahl von Tests ausgeführt werden,
um die Funktion der einzelnen Komponenten und die allgemeine Produzierbarkeit sicherzustellen.
Dabei hat sich die Anzahl der zu testenden Funktionen in den letzten Jahren signifikant gesteigert.
Da die Herstellung dieser Vorserienfahrzeuge sehr kostenintensiv und die Ausführung der dazugehörigen
Tests sehr zeitaufwendig ist, soll für eine gegebene Anzahl an Tests die Zahl der zu produzierenden
Testfahrzeuge minimiert werden.

Jeder Test gehört dabei einer bestimmten Kategorie an,
die über die Reihenfolge der Ausführung entscheidet.
Crashtests (Z) müssen zum Beispiel immer als letzter Test eines
Vorserienautos durchgeführt werden, da diese Teile der
Vorserienfahrzeuge zerstören können und somit die
Ausführung der anderen Tests unmöglich machen.

Die genauen Zusammenhänge der Testkategorien können den
\cref{fig:test_category,fig:test_category2} entnommen werden.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{images/testfahrzeug_problem/Bench-QC_TVC_simplified_Matrix}
    \caption{Zusammenhang der Testkategorien als Matrix}
    \label{fig:test_category}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{images/testfahrzeug_problem/Bench-QC_TVC_simplified_dependencies}
    \caption{Zusammenhang der Testkategorien vereinfacht als gerichteter Graph}
    \label{fig:test_category2}
\end{figure}

Die Testfahrzeuge werden in drei verschiedenen, teilweise überlappenden,
Bauphasen produziert, die in \cref{fig:test_times} dargestellt sind.
Jeder Test ist an Fahrzeuge einer bestimmten Bauphase gekoppelt.
Eine Bauphase erstreckt sich über mehr als ein Jahr.
Die Tests müssen spätestens ein Jahr nach Bau eines
Fahrzeugs absolviert sein.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{images/testfahrzeug_problem/test_times}
    \caption{Bauphasen der Vorserienfahrzeuge}
    \label{fig:test_times}
\end{figure}

Pro konkreter Bauphase ist somit eine Menge an Tests vorgegeben,
die auf $n$ verschiedenen Testfahrzeugen durchgeführt werden müssen.
Pro Test sind dabei gewisse Sonderausstattungen (SAs) vorgegeben oder ausgeschlossen.
In Testfahrzeuge können je nach Modelltyp unterschiedliche SAs
verbaut werden. Manche SAs können andere SAs fordern oder ausschließen.
Zum Beispiel kann ein Auto nicht gleichzeitig einen $4$- und $8$
Zylindermotor verbaut haben. Diese direkten Abhängigkeiten können auf die Tests
übertragen werden, sodass eine minimale Anzahl an Testfahrzeugen gefunden werden kann.

\subsubsection{Transformation Testinkompatibilitäten}

Ziel ist es herauszufinden, welche Tests auf demselben Testfahrzeug getestet
werden dürfen. Dies ergibt sich aus den folgenden Informationen:

\begin{itemize}
    \item Abhängigkeiten und Ausschlüsse der SAs
    \item Verfügbare Testfahrzeugkategorien
    \item Forderung von unterschiedlichen Testfahrzeugen
    \item Zugehörigkeit zu Testkategorien
\end{itemize}

\paragraph{Abhängigkeiten und Ausschlüsse der SAs}
Für jeden Tests ist bekannt, welche SAs des Testfahrzeugs gefordert werden.
Neben den direkten Abhängigkeiten gibt es auch die indirekten, die sich aus den
geforderten SAs ergeben. Wie die indirekten Abhängigkeiten auf die Tests übertragen
werden können, sollen exemplarisch die nachfolgenden Regeln zeigen.

Angenommen eine Sonderausstattung $SA1$ wird gefordert.

\begin{table}[H]
    \label{tab:tableSAs}
    \begin{tabularx}{\textwidth}{ | l | X |}
        Bedingung an SAs & Abhängigkeit im Test mit SA1 \\\hline\hline
        $SA1 \Rightarrow SA2$ & $SA2$ für Test benötigt \\\hline
        $SA1 \Rightarrow \sim SA2$ & $SA2$ für Test ausgeschlossen \\\hline
        $SA1 \Rightarrow SA2~|~SA3$ & $SA2$, $SA3$ oder beide für Test benötigt \\\hline
        Nur eins $SA1, SA2, SA3$ & $SA2$ und $SA3$ für Test ausgeschlossen \\\hline
        $SA1~\&~SA2$ & $SA2$  für Test benötigt \\\hline
        $SA2 \Rightarrow \sim SA1$ & dh. $SA1 \Rightarrow \sim SA2$ \\& $SA2$  für Test ausgeschlossen\\\hline
    \end{tabularx}
\end{table}
\todo{Liste ist nicht vollständig!}
\todo{Marvin: Check Datensatz, exklusives ODER, weitere Abhängigkeiten, die man darstellen müsste?}
Wenn eine benötigte $SA$ oder ausgeschlossene $\sim SA$ gefunden wurde,
müssen auch für diese die Regeln überprüft werden. So ergibt sich eine Menge
an Tests, für die bekannt ist, welche SAs auf dem Testfahrzeug platziert werden
(a) müssen, (b) dürfen und (c) welche nicht platziert werden dürfen.

Tests, die sich ausschließende SAs beinhalten, können z.B. nicht auf demselben
Testfahrzeug durchgeführt werden. Sich gegenseitig bedingende SAs müssen
hingegen im selben Testfahrzeug verbaut werden.

\paragraph{Verfügbare Testfahrzeugkategorien}
Des Weiteren sind auch die SAs auf den Testfahrzeugen eingeschränkt.
Testfahrzeuge gehören unterschiedlichen Testfahrzeugkategorien an.
Jede Testfahrzeugkategorie hat erlaubte SAs.

Vor der Optimierung (als Teil des Pre-Processings) müssen folgende
Punkte sichergestellt werden: mindestens eine Testfahrzeugkategorie
erlaubt alle benötigten Sonderausstattungen eines Tests. Alle
Sonderausstattungen eines Tests müssen miteinander kompatibel sein.

Tests, die nicht auf dem selben Testfahrzeug ausgeführt werden können,
können ebenfalls gegenseitig ausgeschlossen werden.

\paragraph{Forderung von unterschiedlichen Testfahrzeugen}
Es gibt Tests, die mehr als einmal auf unterschiedlichen Testfahrzeugen
durchgeführt werden müssen. Diese Tests schließen sich somit auch gegenseitig aus.

\paragraph{Zugehörigkeit zu Testkategorien}

Aus den Testfahrzeugkategorien ergibt sich die Ausführungsreihenfolge der Tests.
Tests, die zur Kategorie `Z` gehören, dürfen allerdings nur einmal pro Fahrzeug existieren.
Diese Tests sind somit gegenseitig auszuschließen, damit gewährleistet werden kann,
dass nur ein Test pro Fahrzeug zugeteilt werden kann.
Tests anderer Kategorien müssen nicht besonders behandelt werden.

\subsubsection{Transformation zu Bin Packing mit Konflikten}

Gegeben ist eine Liste an Tests einer konkreten Bauphase, die genau einmal durchgeführt werden müssen.
Für jeden Test ist bekannt
\begin{itemize}
    \item welche Tests nicht am selben Fahrzeug durchgeführt werden dürfen,
    \item wie viel Zeit für die Durchführung benötigt wird,
    \item wann er frühestmöglich ausgeführt werden darf und
    \item bis wann er spätestens ausgeführt werden muss.
\end{itemize}

Um die Kosten möglichst gering zu halten, soll die Anzahl der Testfahrzeuge minimiert werden.
Alle Tests müssen ausgeführt werden.

%\subsubsection{Klassische Lösung}\todo[inline]{evtl. ein eigenes Kapitel für das Mapping einfügen.}
Das Testfahrzeugkonfigurationsproblem lässt sich auf das spezielle Bin Packing Problem mit Konflikten
(siehe~\cref{subsubsec:bin-packing-with-conflicts}) abbilden.

Die Testfahrzeuge sind dabei die Behälter, deren Anzahl im Optimum möglichst gering sein muss.
Die Objekte sind die auszuführenden Tests, die in dieser Bauphase abgeschlossen sein müssen.
Hierbei gehen wir davon aus, dass jeder Test genau einer Bauphase zugeordnet ist. Die maximale
Kapazität jedes Behälters ist eine Randbedingung des Optimierungsproblems und zunächst auf ein
Jahr beschränkt.
\todo{Marvin: Check Datensatz, jeder Test nur eine Bauphase?}
Die Test-Durchführungszeit ist in der klassischen Problemformulierung das Gewicht der Objekte.
Alle einem Testfahrzeug zugewiesenen Tests müssen sequenziell innerhalb des Testzeitraums
durchgeführt werden, der der maximalen Kapazität eines Behälters entspricht.
\todo{Marvin: Check Datensatz, Tests sequenziell?}

Die letzten beiden Eigenschaften der Tests bezüglich der Ausführungszeit ignorieren wir zunächst.
Man könnte das Ergebnis des Bin Packing Problems als Grundlage für das Scheduling nutzen, indem
man die durchzuführenden Tests unter Berücksichtigung der Testkategorien sortiert.

Zusammengefasst, lässt sich die Testfahrzeugkonfiguration wie folgt auf die Notation aus
\cref{subsubsec:bin-packing-with-conflicts} mappen:
\begin{table}[H]
    \begin{tabularx}{\textwidth}{  l | X | l }
    Symbol & Bedeutung & Definitionsbereich \\\hline\hline
    Mengen & & \\\hline\hline
    $O$ & Menge der Tests & $\N$\\\hline
    $B$ & Menge der Testfahrzeuge & $\N$\\\hline
    $I$ & Menge der inkompatiblen Tests & $\N\times\N$\\\hline\hline
    Konstanten &  &  \\\hline\hline
    $c$ & Ein Jahr & $\N$\\\hline
    $w_o$ & Benötigte Zeit für Test $o\in O$ & $\N$\\\hline\hline
    Variablen &  &  \\\hline\hline
    $x_{ob}$ & Genau dann, wenn $x_{ob}=1$ wird Test $o\in O$ dem Testfahrzeug $b\in B$ zugeteilt & $\B$\\\hline
    \end{tabularx}
    \caption{Notation zu Testfahrzeugkonfiguration}\label{tab:notation_test_vehicle}
\end{table}
\todo{Marvin: Check Datensatz, fehlt irgendwas?}
